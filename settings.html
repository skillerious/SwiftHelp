<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <title>SwiftHelp Settings (Dark Themed)</title>

  <!-- Bootstrap 5 CSS (CDN) -->
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
    rel="stylesheet"
  />

  <style>
    /* Remove scroll bars, ensure no body overflow */
    html, body {
      margin: 0;
      padding: 0;
      background-color: #1e1e1e;
      color: #f0f0f0;
      font-family: "Segoe UI", Tahoma, sans-serif;
      height: 100%;
      width: 100%;
      overflow: hidden; /* no scroll */
    }

    /* Container: no card, just a direct layout */
    .settings-container {
      display: flex;
      flex-direction: row;
      height: 100%;
      /* If you want a minimal margin or padding, set it: */
    }

    /* Sidebar styling */
    .sidebar {
      background-color: #2a2a2a;
      min-width: 220px;
      max-width: 240px;
      border-right: 1px solid #444;
      padding: 1rem;
      box-sizing: border-box;
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    .sidebar h2 {
      font-size: 1.2rem;
      margin: 0 0 0.5rem 0;
    }

    .sidebar .nav {
      flex: 1; /* let it grow */
      display: flex;
      flex-direction: column;
      gap: 0.2rem;
    }

    .sidebar .nav .nav-link {
      background-color: transparent;
      border: 1px solid transparent;
      border-radius: 4px;
      color: #bbb;
      padding: 0.5rem;
      transition: background-color 0.2s;
    }
    .sidebar .nav .nav-link:hover {
      background-color: #3b3b3b;
      color: #fff;
    }
    .sidebar .nav .nav-link.active {
      color: #fff;
      font-weight: 600;
      background-color: #3a87fc;
      border-color: #3a87fc;
    }

    /* main settings content */
    .content-area {
      flex: 1;
      display: flex;
      flex-direction: column;
      padding: 1rem;
      box-sizing: border-box;
      overflow-y: auto; /* only if you need scroll for large content */
    }

    .content-area h3 {
      font-size: 1.25rem;
      margin-bottom: 1rem;
    }

    /* Tab-specific container => remove default border from nav. */
    .tab-content {
      flex: 1; /* fill vertical space */
      display: flex;
      flex-direction: column;
    }

    .tab-pane {
      flex: 1;
      overflow-y: auto; /* if you want each pane to scroll internally */
    }

    .form-check-input:checked {
      background-color: #3a87fc;
      border-color: #3a87fc;
    }
    .form-control {
      background-color: #333;
      color: #f0f0f0;
      border: 1px solid #555;
    }
    .form-control:focus {
      border-color: #3a87fc;
      outline: none;
      box-shadow: 0 0 0 0.2rem rgba(58,135,252,0.25);
    }

    /* Footer with Save & Cancel */
    .footer-buttons {
      display: flex;
      justify-content: flex-end;
      gap: 0.5rem;
      margin-top: 1rem;
    }
    .btn-primary {
      background-color: #3a87fc;
      border: 1px solid #3a87fc;
    }
    .btn-primary:hover {
      background-color: #3072d7;
      border-color: #3072d7;
    }
    .btn-secondary {
      background-color: #444;
      border: 1px solid #555;
      color: #ddd;
    }
    .btn-secondary:hover {
      background-color: #555;
      color: #fff;
    }

  </style>
</head>
<body>

  <div class="settings-container">
    <!-- Sidebar -->
    <div class="sidebar">
      <h2>SwiftHelp Settings</h2>
      <nav class="nav flex-column" id="settingsNav" role="tablist">
        <button
          class="nav-link active"
          id="nav-appearance-tab"
          data-bs-toggle="tab"
          data-bs-target="#appearance"
          type="button"
          role="tab"
          aria-controls="appearance"
          aria-selected="true"
        >
          Appearance
        </button>
        <button
          class="nav-link"
          id="nav-general-tab"
          data-bs-toggle="tab"
          data-bs-target="#general"
          type="button"
          role="tab"
          aria-controls="general"
          aria-selected="false"
        >
          General
        </button>
        <button
          class="nav-link"
          id="nav-advanced-tab"
          data-bs-toggle="tab"
          data-bs-target="#advanced"
          type="button"
          role="tab"
          aria-controls="advanced"
          aria-selected="false"
        >
          Advanced
        </button>
        <button
          class="nav-link"
          id="nav-recent-tab"
          data-bs-toggle="tab"
          data-bs-target="#recent"
          type="button"
          role="tab"
          aria-controls="recent"
          aria-selected="false"
        >
          Recent
        </button>
        <button
          class="nav-link"
          id="nav-extra-tab"
          data-bs-toggle="tab"
          data-bs-target="#extras"
          type="button"
          role="tab"
          aria-controls="extras"
          aria-selected="false"
        >
          Extras
        </button>
      </nav>
    </div>

    <!-- Main Content -->
    <div class="content-area">
      <div class="tab-content flex-column" id="settingsTabContent">
        <!-- Appearance Tab -->
        <div
          class="tab-pane fade show active"
          id="appearance"
          role="tabpanel"
          aria-labelledby="nav-appearance-tab"
        >
          <h3>Appearance</h3>
          <div class="mb-3 form-check form-switch">
            <input
              class="form-check-input"
              type="checkbox"
              id="chk-light-mode"
            />
            <label class="form-check-label" for="chk-light-mode">
              Light Mode
            </label>
          </div>
          <div class="mb-3 form-check form-switch">
            <input
              class="form-check-input"
              type="checkbox"
              id="chk-pin-sidebar"
            />
            <label class="form-check-label" for="chk-pin-sidebar">
              Pin Sidebar
            </label>
          </div>
        </div>

        <!-- General Tab -->
        <div
          class="tab-pane fade"
          id="general"
          role="tabpanel"
          aria-labelledby="nav-general-tab"
        >
          <h3>General</h3>
          <div class="mb-3 form-check form-switch">
            <input
              class="form-check-input"
              type="checkbox"
              id="chk-auto-save"
            />
            <label class="form-check-label" for="chk-auto-save">
              Auto Save
            </label>
          </div>
          <div class="mb-3 form-check form-switch">
            <input
              class="form-check-input"
              type="checkbox"
              id="chk-disable-animations"
            />
            <label class="form-check-label" for="chk-disable-animations">
              Disable Animations
            </label>
          </div>
          <label for="updateFrequency" class="form-label">Update Frequency</label>
          <select id="updateFrequency" class="form-select mb-3">
            <option value="manual">Manual Only</option>
            <option value="daily">Daily</option>
            <option value="weekly">Weekly</option>
          </select>
          <label for="languageSelect" class="form-label">Language</label>
          <select id="languageSelect" class="form-select mb-3">
            <option value="en">English</option>
            <option value="es">Spanish</option>
            <option value="fr">French</option>
          </select>
          <div class="mb-3 form-check form-switch">
            <input
              class="form-check-input"
              type="checkbox"
              id="chk-check-updates"
            />
            <label class="form-check-label" for="chk-check-updates">
              Check for updates automatically
            </label>
          </div>
        </div>

        <!-- Advanced Tab -->
        <div
          class="tab-pane fade"
          id="advanced"
          role="tabpanel"
          aria-labelledby="nav-advanced-tab"
        >
          <h3>Advanced</h3>
          <div class="mb-3 form-check form-switch">
            <input class="form-check-input" type="checkbox" id="chk-dev-mode" />
            <label class="form-check-label" for="chk-dev-mode">
              Developer Mode
            </label>
          </div>
          <label for="txt-custom-css" class="form-label">Custom CSS</label>
          <textarea
            class="form-control mb-3"
            id="txt-custom-css"
            rows="3"
            placeholder="Paste or write any custom CSS..."
          ></textarea>
        </div>

        <!-- Recent Tab -->
        <div
          class="tab-pane fade"
          id="recent"
          role="tabpanel"
          aria-labelledby="nav-recent-tab"
        >
          <h3>Recent Files</h3>
          <p class="text-secondary">Below is your recent files list:</p>
          <ul class="list-group mb-3" id="recent-files-list"></ul>
          <button
            class="btn btn-secondary btn-sm"
            id="btn-clear-recent"
          >
            Clear Recent List
          </button>
        </div>

        <!-- Extras tab => demonstration of more settings -->
        <div
          class="tab-pane fade"
          id="extras"
          role="tabpanel"
          aria-labelledby="nav-extra-tab"
        >
          <h3>Extras</h3>
          <p class="mb-1">Spell-check Options:</p>
          <select id="spellCheckLanguage" class="form-select mb-3">
            <option value="en-US">English (US)</option>
            <option value="en-GB">English (GB)</option>
            <option value="de">German</option>
            <option value="fr">French</option>
          </select>
          <div class="mb-3 form-check form-switch">
            <input class="form-check-input" type="checkbox" id="chk-enable-spellcheck" />
            <label class="form-check-label" for="chk-enable-spellcheck">
              Enable Spell Check
            </label>
          </div>
          <p class="mb-1">Beta Channel:</p>
          <select id="betaChannel" class="form-select mb-3">
            <option value="none">No Beta</option>
            <option value="beta">Beta Channel</option>
          </select>
        </div>
      </div>

      <!-- Footer: Save & Cancel -->
      <div class="footer-buttons">
        <button type="button" class="btn btn-primary" id="btn-save-close">
          Save changes
        </button>
        <button type="button" class="btn btn-secondary" id="btn-cancel">
          Cancel
        </button>
      </div>
    </div>
  </div>

  <!-- Bootstrap 5 JS (CDN) -->
  <script
    src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"
  ></script>
  <!-- Our Script -->
  <script>
    const { ipcRenderer } = require('electron');

    // Store app settings
    let pinnedSidebar = false;
    let autoSave = false;
    let isLightMode = false;
    let recentFiles = [];
    let disableAnimations = false;
    let devMode = false;
    let checkUpdates = false;
    let spellCheckLang = 'en-US';
    let enableSpellcheck = false;
    let betaChannel = 'none';

    window.addEventListener('DOMContentLoaded', () => {
      ipcRenderer.invoke('get-app-settings').then((settings) => {
        // Extract from saved settings if present
        pinnedSidebar = !!settings.pinnedSidebar;
        autoSave = !!settings.autoSave;
        isLightMode = !!settings.lightMode;
        recentFiles = settings.recentFiles || [];
        devMode = !!settings.devMode; // new potential field
        checkUpdates = !!settings.checkUpdates;
        disableAnimations = !!settings.disableAnimations;
        spellCheckLang = settings.spellCheckLang || 'en-US';
        enableSpellcheck = !!settings.enableSpellcheck;
        betaChannel = settings.betaChannel || 'none';

        // Update toggles
        document.getElementById('chk-pin-sidebar').checked = pinnedSidebar;
        document.getElementById('chk-auto-save').checked = autoSave;
        document.getElementById('chk-light-mode').checked = isLightMode;
        document.getElementById('chk-dev-mode').checked = devMode;
        document.getElementById('chk-check-updates').checked = checkUpdates;
        document.getElementById('chk-disable-animations').checked = disableAnimations;

        // Spell-check
        document.getElementById('spellCheckLanguage').value = spellCheckLang;
        document.getElementById('chk-enable-spellcheck').checked = enableSpellcheck;
        document.getElementById('betaChannel').value = betaChannel;

        // Build recent files
        const ul = document.getElementById('recent-files-list');
        ul.innerHTML = '';
        if (recentFiles.length === 0) {
          const li = document.createElement('li');
          li.textContent = '(No recent files)';
          li.classList.add('list-group-item', 'text-muted');
          ul.appendChild(li);
        } else {
          recentFiles.forEach((filePath) => {
            const li = document.createElement('li');
            li.textContent = filePath;
            li.classList.add('list-group-item');
            ul.appendChild(li);
          });
        }
      });
    });

    // Toggle events
    document.getElementById('chk-pin-sidebar').addEventListener('change', e => {
      pinnedSidebar = e.target.checked;
    });
    document.getElementById('chk-auto-save').addEventListener('change', e => {
      autoSave = e.target.checked;
    });
    document.getElementById('chk-light-mode').addEventListener('change', e => {
      isLightMode = e.target.checked;
    });
    document.getElementById('chk-dev-mode').addEventListener('change', e => {
      devMode = e.target.checked;
    });
    document.getElementById('chk-check-updates').addEventListener('change', e => {
      checkUpdates = e.target.checked;
    });
    document
      .getElementById('chk-disable-animations')
      .addEventListener('change', e => {
        disableAnimations = e.target.checked;
      });

    // Spell-check
    document
      .getElementById('spellCheckLanguage')
      .addEventListener('change', e => {
        spellCheckLang = e.target.value;
      });
    document
      .getElementById('chk-enable-spellcheck')
      .addEventListener('change', e => {
        enableSpellcheck = e.target.checked;
      });
    document
      .getElementById('betaChannel')
      .addEventListener('change', e => {
        betaChannel = e.target.value;
      });

    // Clear recent
    document.getElementById('btn-clear-recent')?.addEventListener('click', () => {
      recentFiles = [];
      const ul = document.getElementById('recent-files-list');
      ul.innerHTML = '';
      const li = document.createElement('li');
      li.textContent = '(No recent files)';
      li.classList.add('list-group-item', 'text-muted');
      ul.appendChild(li);
    });

    // Save & Close
    document.getElementById('btn-save-close').addEventListener('click', () => {
      ipcRenderer.send('save-app-settings', {
        pinnedSidebar,
        autoSave,
        lightMode: isLightMode,
        devMode,
        checkUpdates,
        disableAnimations,
        spellCheckLang,
        enableSpellcheck,
        betaChannel,
        recentFiles
      });
      window.close();
    });

    // Cancel => just close
    document.getElementById('btn-cancel').addEventListener('click', () => {
      window.close();
    });
  </script>
</body>
</html>
